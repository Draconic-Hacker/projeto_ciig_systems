<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CIIG System - Gest√£o Completa de Marketplace</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .dark {
            --tw-bg-opacity: 1;
            background-color: rgb(17 24 39 / var(--tw-bg-opacity));
            color: white;
        }
        .transition-all {
            transition: all 0.3s ease;
        }
        .animate-pulse-custom {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        .notification {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        .tab-active {
            border-bottom: 2px solid #3B82F6;
            color: #3B82F6;
        }
    </style>
</head>
<body class="bg-gray-50 transition-all duration-300" id="body">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b border-gray-200 transition-all duration-300" id="header">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <h1 class="text-2xl font-bold text-blue-600">CIIG System</h1>
                        <p class="text-xs text-gray-500">Marketplace Management</p>
                    </div>
                    <nav class="hidden md:ml-8 md:flex md:space-x-8">
                        <a href="#" onclick="showTab('dashboard', this)" class="tab-link tab-active px-3 py-2 text-sm font-medium transition-colors">Dashboard</a>
                        <a href="#" onclick="showTab('inventory', this)" class="tab-link text-gray-500 hover:text-gray-900 px-3 py-2 text-sm font-medium transition-colors">Invent√°rio</a>
                        <a href="#" onclick="showTab('orders', this)" class="tab-link text-gray-500 hover:text-gray-900 px-3 py-2 text-sm font-medium transition-colors">Pedidos</a>
                        <a href="#" onclick="showTab('sellers', this)" class="tab-link text-gray-500 hover:text-gray-900 px-3 py-2 text-sm font-medium transition-colors">Vendedores</a>
                        <a href="#" onclick="showTab('analytics', this)" class="tab-link text-gray-500 hover:text-gray-900 px-3 py-2 text-sm font-medium transition-colors">Analytics</a>
                        <a href="#" onclick="showTab('logistics', this)" class="tab-link text-gray-500 hover:text-gray-900 px-3 py-2 text-sm font-medium transition-colors">Log√≠stica</a>
                    </nav>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- Search Global -->
                    <div class="relative hidden md:block">
                        <input type="text" placeholder="Busca global..." class="w-64 pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" id="globalSearch" onkeyup="globalSearch(event)">
                        <svg class="absolute left-3 top-2.5 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                    </div>

                    <!-- Quick Actions -->
                    <div class="relative">
                        <button onclick="toggleQuickActions()" class="p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                            </svg>
                        </button>
                        <div id="quickActionsPanel" class="hidden absolute right-0 mt-2 w-64 bg-white rounded-md shadow-lg z-50 border">
                            <div class="p-4">
                                <h3 class="text-sm font-medium text-gray-900 mb-3">A√ß√µes R√°pidas</h3>
                                <div class="space-y-2">
                                    <button onclick="addNewItem()" class="w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded">‚ûï Adicionar Produto</button>
                                    <button onclick="exportData()" class="w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded">üìä Exportar Dados</button>
                                    <button onclick="generateReport()" class="w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded">üìã Gerar Relat√≥rio</button>
                                    <button onclick="backupData()" class="w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded">üíæ Backup</button>
                                    <button onclick="systemSettings()" class="w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded">‚öôÔ∏è Configura√ß√µes</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Notifications -->
                    <div class="relative">
                        <button onclick="toggleNotifications()" class="p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors relative">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19H6.5A2.5 2.5 0 0 1 4 16.5v-7A2.5 2.5 0 0 1 6.5 7h11A2.5 2.5 0 0 1 6.5 7h11A2.5 2.5 0 0 1 20 9.5v2"></path>
                            </svg>
                            <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center animate-pulse" id="notificationCount">3</span>
                        </button>
                        <div id="notificationPanel" class="hidden absolute right-0 mt-2 w-80 bg-white rounded-md shadow-lg z-50 border">
                            <div class="p-4">
                                <h3 class="text-sm font-medium text-gray-900 mb-3">Notifica√ß√µes</h3>
                                <div class="space-y-3">
                                    <div class="flex items-start space-x-3 p-2 hover:bg-gray-50 rounded">
                                        <div class="w-2 h-2 bg-red-500 rounded-full mt-2"></div>
                                        <div>
                                            <p class="text-sm text-gray-900">Estoque baixo: Smartphone Samsung</p>
                                            <p class="text-xs text-gray-500">H√° 5 minutos</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start space-x-3 p-2 hover:bg-gray-50 rounded">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full mt-2"></div>
                                        <div>
                                            <p class="text-sm text-gray-900">Novo pedido #12345</p>
                                            <p class="text-xs text-gray-500">H√° 10 minutos</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start space-x-3 p-2 hover:bg-gray-50 rounded">
                                        <div class="w-2 h-2 bg-green-500 rounded-full mt-2"></div>
                                        <div>
                                            <p class="text-sm text-gray-900">Vendedor aprovado: TechStore</p>
                                            <p class="text-xs text-gray-500">H√° 1 hora</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button onclick="toggleTheme()" class="p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors" id="themeToggle">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                        </svg>
                    </button>
                    <div class="flex items-center space-x-2">
                        <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center">
                            <span class="text-white text-sm font-medium">A</span>
                        </div>
                        <span class="text-sm font-medium text-gray-700" id="userName">Admin CIIG</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Dashboard Tab -->
        <div id="dashboardTab" class="tab-content">
            <!-- KPI Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-white rounded-lg shadow p-6 transition-all duration-300" id="statsCard1">
                    <div class="flex items-center">
                        <div class="flex-shrink-0">
                            <div class="w-8 h-8 bg-blue-500 rounded-md flex items-center justify-center">
                                <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                                </svg>
                            </div>
                        </div>
                        <div class="ml-5 w-0 flex-1">
                            <dl>
                                <dt class="text-sm font-medium text-gray-500 truncate">Receita Total</dt>
                                <dd class="text-lg font-medium text-gray-900" id="totalRevenue">R$ 2.847.392</dd>
                                <dd class="text-sm text-green-600">+12.5% vs m√™s anterior</dd>
                            </dl>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow p-6 transition-all duration-300" id="statsCard2">
                    <div class="flex items-center">
                        <div class="flex-shrink-0">
                            <div class="w-8 h-8 bg-green-500 rounded-md flex items-center justify-center">
                                <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
                                </svg>
                            </div>
                        </div>
                        <div class="ml-5 w-0 flex-1">
                            <dl>
                                <dt class="text-sm font-medium text-gray-500 truncate">Pedidos Hoje</dt>
                                <dd class="text-lg font-medium text-gray-900" id="todayOrders">1,247</dd>
                                <dd class="text-sm text-green-600">+8.2% vs ontem</dd>
                            </dl>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow p-6 transition-all duration-300" id="statsCard3">
                    <div class="flex items-center">
                        <div class="flex-shrink-0">
                            <div class="w-8 h-8 bg-yellow-500 rounded-md flex items-center justify-center">
                                <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                                </svg>
                            </div>
                        </div>
                        <div class="ml-5 w-0 flex-1">
                            <dl>
                                <dt class="text-sm font-medium text-gray-500 truncate">Vendedores Ativos</dt>
                                <dd class="text-lg font-medium text-gray-900" id="activeSellers">2,847</dd>
                                <dd class="text-sm text-blue-600">+156 novos este m√™s</dd>
                            </dl>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow p-6 transition-all duration-300" id="statsCard4">
                    <div class="flex items-center">
                        <div class="flex-shrink-0">
                            <div class="w-8 h-8 bg-purple-500 rounded-md flex items-center justify-center">
                                <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path>
                                </svg>
                            </div>
                        </div>
                        <div class="ml-5 w-0 flex-1">
                            <dl>
                                <dt class="text-sm font-medium text-gray-500 truncate">Avalia√ß√£o M√©dia</dt>
                                <dd class="text-lg font-medium text-gray-900" id="avgRating">4.7/5.0</dd>
                                <dd class="text-sm text-green-600">+0.2 vs m√™s anterior</dd>
                            </dl>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <div class="bg-white rounded-lg shadow p-6 transition-all duration-300" id="chartCard1">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Vendas por Per√≠odo</h3>
                    <div style="height: 300px;">
                        <canvas id="salesChart"></canvas>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow p-6 transition-all duration-300" id="chartCard2">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Top Categorias</h3>
                    <div style="height: 300px;">
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Advanced Widgets -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                <!-- Performance Widget -->
                <div class="bg-white shadow rounded-lg p-6 transition-all duration-300">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Performance do Sistema</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">CPU</span>
                            <div class="flex items-center space-x-2">
                                <div class="w-24 bg-gray-200 rounded-full h-2">
                                    <div class="bg-blue-600 h-2 rounded-full" style="width: 45%"></div>
                                </div>
                                <span class="text-sm font-medium">45%</span>
                            </div>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Mem√≥ria</span>
                            <div class="flex items-center space-x-2">
                                <div class="w-24 bg-gray-200 rounded-full h-2">
                                    <div class="bg-green-600 h-2 rounded-full" style="width: 67%"></div>
                                </div>
                                <span class="text-sm font-medium">67%</span>
                            </div>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Armazenamento</span>
                            <div class="flex items-center space-x-2">
                                <div class="w-24 bg-gray-200 rounded-full h-2">
                                    <div class="bg-yellow-600 h-2 rounded-full" style="width: 82%"></div>
                                </div>
                                <span class="text-sm font-medium">82%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Top Products Widget -->
                <div class="bg-white shadow rounded-lg p-6 transition-all duration-300">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Top Produtos</h3>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
                                    <span class="text-xs font-medium text-blue-600">1</span>
                                </div>
                                <div>
                                    <p class="text-sm font-medium text-gray-900">iPhone 15 Pro</p>
                                    <p class="text-xs text-gray-500">234 vendas</p>
                                </div>
                            </div>
                            <span class="text-sm font-medium text-green-600">+12%</span>
                        </div>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center">
                                    <span class="text-xs font-medium text-green-600">2</span>
                                </div>
                                <div>
                                    <p class="text-sm font-medium text-gray-900">Notebook Dell</p>
                                    <p class="text-xs text-gray-500">189 vendas</p>
                                </div>
                            </div>
                            <span class="text-sm font-medium text-green-600">+8%</span>
                        </div>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center">
                                    <span class="text-xs font-medium text-yellow-600">3</span>
                                </div>
                                <div>
                                    <p class="text-sm font-medium text-gray-900">T√™nis Nike</p>
                                    <p class="text-xs text-gray-500">156 vendas</p>
                                </div>
                            </div>
                            <span class="text-sm font-medium text-red-600">-3%</span>
                        </div>
                    </div>
                </div>

                <!-- Weather & Time Widget -->
                <div class="bg-white shadow rounded-lg p-6 transition-all duration-300">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Informa√ß√µes</h3>
                    <div class="space-y-4">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-gray-900" id="currentTime">--:--</div>
                            <div class="text-sm text-gray-500" id="currentDate">-- de ---- de ----</div>
                        </div>
                        <div class="border-t pt-4">
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-600">Usu√°rios Online</span>
                                <div class="flex items-center space-x-1">
                                    <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                                    <span class="text-sm font-medium">1,247</span>
                                </div>
                            </div>
                            <div class="flex items-center justify-between mt-2">
                                <span class="text-sm text-gray-600">Servidor</span>
                                <span class="text-sm font-medium text-green-600">Online</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="bg-white shadow rounded-lg transition-all duration-300 mb-8" id="activityCard">
                <div class="px-4 py-5 sm:p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-medium text-gray-900">Atividade Recente</h3>
                        <button onclick="refreshActivity()" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                            üîÑ Atualizar
                        </button>
                    </div>
                    <div class="flow-root">
                        <ul class="-mb-8">
                            <li>
                                <div class="relative pb-8">
                                    <div class="relative flex space-x-3">
                                        <div class="flex h-8 w-8 items-center justify-center rounded-full bg-green-500">
                                            <svg class="h-5 w-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                                            </svg>
                                        </div>
                                        <div class="min-w-0 flex-1 pt-1.5">
                                            <p class="text-sm text-gray-500">Pedido <span class="font-medium text-gray-900">#12345</span> foi entregue</p>
                                            <p class="text-xs text-gray-400">H√° 2 minutos</p>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="relative pb-8">
                                    <div class="relative flex space-x-3">
                                        <div class="flex h-8 w-8 items-center justify-center rounded-full bg-blue-500">
                                            <svg class="h-5 w-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                                <path d="M8 9a3 3 0 100-6 3 3 0 000 6zM8 11a6 6 0 016 6H2a6 6 0 016-6z"></path>
                                            </svg>
                                        </div>
                                        <div class="min-w-0 flex-1 pt-1.5">
                                            <p class="text-sm text-gray-500">Novo vendedor <span class="font-medium text-gray-900">TechStore</span> se cadastrou</p>
                                            <p class="text-xs text-gray-400">H√° 15 minutos</p>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="relative">
                                    <div class="relative flex space-x-3">
                                        <div class="flex h-8 w-8 items-center justify-center rounded-full bg-yellow-500">
                                            <svg class="h-5 w-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                                            </svg>
                                        </div>
                                        <div class="min-w-0 flex-1 pt-1.5">
                                            <p class="text-sm text-gray-500">Alerta de estoque baixo para <span class="font-medium text-gray-900">iPhone 15</span></p>
                                            <p class="text-xs text-gray-400">H√° 1 hora</p>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Inventory Tab -->
        <div id="inventoryTab" class="tab-content hidden">
            <!-- Inventory Management -->
            <div class="bg-white shadow rounded-lg transition-all duration-300" id="inventoryTable">
                <div class="px-4 py-5 sm:p-6">
                    <div class="sm:flex sm:items-center sm:justify-between mb-6">
                        <div class="sm:flex-auto">
                            <h1 class="text-xl font-semibold text-gray-900">Gest√£o de Invent√°rio</h1>
                            <p class="mt-2 text-sm text-gray-700">Controle completo de produtos, pre√ßos e estoque em tempo real.</p>
                        </div>
                        <div class="mt-4 sm:mt-0 sm:ml-16 sm:flex-none space-x-3">
                            <button onclick="bulkImport()" class="inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 transition-colors">
                                Importar CSV
                            </button>
                            <button onclick="addNewItem()" class="inline-flex items-center justify-center rounded-md border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-blue-700 transition-colors">
                                Adicionar Produto
                            </button>
                        </div>
                    </div>

                    <!-- Advanced Filters -->
                    <div class="mb-6 bg-gray-50 p-4 rounded-lg">
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Buscar</label>
                                <input type="text" id="searchInput" placeholder="Nome, SKU, descri√ß√£o..." class="block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2 border" onkeyup="filterTable()">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Categoria</label>
                                <select id="categoryFilter" class="block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2 border" onchange="filterTable()">
                                    <option value="">Todas as Categorias</option>
                                    <option value="Eletr√¥nicos">Eletr√¥nicos</option>
                                    <option value="Roupas">Roupas & Acess√≥rios</option>
                                    <option value="Casa">Casa & Jardim</option>
                                    <option value="Esportes">Esportes & Fitness</option>
                                    <option value="Livros">Livros & M√≠dia</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                                <select id="statusFilter" class="block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2 border" onchange="filterTable()">
                                    <option value="">Todos Status</option>
                                    <option value="Ativo">Ativo</option>
                                    <option value="Pausado">Pausado</option>
                                    <option value="Esgotado">Esgotado</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Vendedor</label>
                                <select id="sellerFilter" class="block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm px-3 py-2 border" onchange="filterTable()">
                                    <option value="">Todos Vendedores</option>
                                    <option value="CIIG Store">CIIG Store</option>
                                    <option value="TechWorld">TechWorld</option>
                                    <option value="FashionHub">FashionHub</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Advanced Table Controls -->
                    <div class="flex justify-between items-center mb-4">
                        <div class="flex items-center space-x-4">
                            <select id="itemsPerPage" onchange="changeItemsPerPage()" class="border border-gray-300 rounded-md px-3 py-2 text-sm">
                                <option value="10">10 por p√°gina</option>
                                <option value="25" selected>25 por p√°gina</option>
                                <option value="50">50 por p√°gina</option>
                                <option value="100">100 por p√°gina</option>
                            </select>
                            <button onclick="toggleColumnVisibility()" class="px-3 py-2 border border-gray-300 rounded-md text-sm hover:bg-gray-50">
                                üëÅÔ∏è Colunas
                            </button>
                            <button onclick="saveTableView()" class="px-3 py-2 border border-gray-300 rounded-md text-sm hover:bg-gray-50">
                                üíæ Salvar Visualiza√ß√£o
                            </button>
                        </div>
                        <div class="text-sm text-gray-500">
                            Mostrando <span id="showingStart">1</span>-<span id="showingEnd">25</span> de <span id="totalItems">0</span> itens
                        </div>
                    </div>

                    <!-- Products Table -->
                    <div class="overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg">
                        <table class="min-w-full divide-y divide-gray-300">
                            <thead class="bg-gray-50" id="tableHead">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        <input type="checkbox" id="selectAll" onchange="toggleSelectAll()" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                    </th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortTable('name')">
                                        Produto <span id="sort-name">‚ÜïÔ∏è</span>
                                    </th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortTable('seller')">
                                        Vendedor <span id="sort-seller">‚ÜïÔ∏è</span>
                                    </th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortTable('price')">
                                        Pre√ßo <span id="sort-price">‚ÜïÔ∏è</span>
                                    </th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortTable('quantity')">
                                        Estoque <span id="sort-quantity">‚ÜïÔ∏è</span>
                                    </th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortTable('sales')">
                                        Vendas <span id="sort-sales">‚ÜïÔ∏è</span>
                                    </th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortTable('rating')">
                                        Avalia√ß√£o <span id="sort-rating">‚ÜïÔ∏è</span>
                                    </th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200" id="tableBody">
                                <!-- Table rows will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Pagination -->
                    <div class="flex items-center justify-between mt-4">
                        <div class="flex items-center space-x-2">
                            <button onclick="previousPage()" id="prevBtn" class="px-3 py-2 border border-gray-300 rounded-md text-sm hover:bg-gray-50 disabled:opacity-50" disabled>
                                ‚Üê Anterior
                            </button>
                            <div class="flex space-x-1" id="pageNumbers">
                                <!-- Page numbers will be generated by JavaScript -->
                            </div>
                            <button onclick="nextPage()" id="nextBtn" class="px-3 py-2 border border-gray-300 rounded-md text-sm hover:bg-gray-50">
                                Pr√≥ximo ‚Üí
                            </button>
                        </div>
                        <button onclick="goToPage()" class="px-3 py-2 border border-gray-300 rounded-md text-sm hover:bg-gray-50">
                            Ir para p√°gina...
                        </button>
                    </div>

                    <!-- Bulk Actions -->
                    <div id="bulkActions" class="hidden mt-4 p-4 bg-blue-50 rounded-lg">
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-blue-700"><span id="selectedCount">0</span> itens selecionados</span>
                            <div class="space-x-2">
                                <button onclick="bulkUpdatePrice()" class="px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors">Atualizar Pre√ßos</button>
                                <button onclick="bulkUpdateStock()" class="px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700 transition-colors">Atualizar Estoque</button>
                                <button onclick="bulkPause()" class="px-3 py-1 bg-yellow-600 text-white text-sm rounded hover:bg-yellow-700 transition-colors">Pausar</button>
                                <button onclick="bulkDelete()" class="px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors">Excluir</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Orders Tab -->
        <div id="ordersTab" class="tab-content hidden">
            <div class="bg-white shadow rounded-lg transition-all duration-300">
                <div class="px-4 py-5 sm:p-6">
                    <h1 class="text-xl font-semibold text-gray-900 mb-6">Gest√£o de Pedidos</h1>
                    
                    <!-- Order Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <div class="text-2xl font-bold text-blue-600">1,247</div>
                            <div class="text-sm text-blue-600">Pedidos Hoje</div>
                        </div>
                        <div class="bg-yellow-50 p-4 rounded-lg">
                            <div class="text-2xl font-bold text-yellow-600">89</div>
                            <div class="text-sm text-yellow-600">Aguardando Envio</div>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg">
                            <div class="text-2xl font-bold text-green-600">2,156</div>
                            <div class="text-sm text-green-600">Em Tr√¢nsito</div>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <div class="text-2xl font-bold text-purple-600">R$ 89,432</div>
                            <div class="text-sm text-purple-600">Receita Hoje</div>
                        </div>
                    </div>

                    <!-- Orders Table -->
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-300">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Pedido</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Cliente</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Produtos</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Total</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Data</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200" id="ordersTableBody">
                                <!-- Orders will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sellers Tab -->
        <div id="sellersTab" class="tab-content hidden">
            <div class="bg-white shadow rounded-lg transition-all duration-300">
                <div class="px-4 py-5 sm:p-6">
                    <div class="sm:flex sm:items-center sm:justify-between mb-6">
                        <div>
                            <h1 class="text-xl font-semibold text-gray-900">Gest√£o de Vendedores</h1>
                            <p class="mt-2 text-sm text-gray-700">Controle e monitore todos os vendedores da plataforma.</p>
                        </div>
                        <button onclick="addNewSeller()" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors">
                            Aprovar Vendedor
                        </button>
                    </div>

                    <!-- Sellers Grid -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="sellersGrid">
                        <!-- Sellers will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div id="analyticsTab" class="tab-content hidden">
            <div class="space-y-6">
                <div class="bg-white shadow rounded-lg p-6">
                    <h1 class="text-xl font-semibold text-gray-900 mb-6">Analytics Avan√ßado</h1>
                    
                    <!-- Analytics Charts -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div>
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Convers√£o por Categoria</h3>
                            <div style="height: 300px;">
                                <canvas id="conversionChart"></canvas>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Ticket M√©dio</h3>
                            <div style="height: 300px;">
                                <canvas id="ticketChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Performance Metrics -->
                <div class="bg-white shadow rounded-lg p-6">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">M√©tricas de Performance</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="text-center">
                            <div class="text-3xl font-bold text-blue-600">2.4s</div>
                            <div class="text-sm text-gray-500">Tempo M√©dio de Carregamento</div>
                        </div>
                        <div class="text-center">
                            <div class="text-3xl font-bold text-green-600">94.2%</div>
                            <div class="text-sm text-gray-500">Taxa de Satisfa√ß√£o</div>
                        </div>
                        <div class="text-center">
                            <div class="text-3xl font-bold text-purple-600">67%</div>
                            <div class="text-sm text-gray-500">Taxa de Convers√£o</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Logistics Tab -->
        <div id="logisticsTab" class="tab-content hidden">
            <div class="bg-white shadow rounded-lg transition-all duration-300">
                <div class="px-4 py-5 sm:p-6">
                    <h1 class="text-xl font-semibold text-gray-900 mb-6">Centro Log√≠stico</h1>
                    
                    <!-- Logistics Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <div class="text-2xl font-bold text-blue-600">156</div>
                            <div class="text-sm text-blue-600">Entregas Hoje</div>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg">
                            <div class="text-2xl font-bold text-green-600">98.5%</div>
                            <div class="text-sm text-green-600">Taxa de Entrega</div>
                        </div>
                        <div class="bg-yellow-50 p-4 rounded-lg">
                            <div class="text-2xl font-bold text-yellow-600">2.3 dias</div>
                            <div class="text-sm text-yellow-600">Tempo M√©dio</div>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <div class="text-2xl font-bold text-purple-600">23</div>
                            <div class="text-sm text-purple-600">Centros de Distribui√ß√£o</div>
                        </div>
                    </div>

                    <!-- Shipping Map -->
                    <div class="bg-gray-100 h-64 rounded-lg flex items-center justify-center mb-6">
                        <div class="text-center">
                            <svg class="w-16 h-16 text-gray-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                            <p class="text-gray-500">Mapa de Entregas em Tempo Real</p>
                            <p class="text-sm text-gray-400">Visualiza√ß√£o interativa das rotas de entrega</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Add Product Modal -->
    <div id="addItemModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
        <div class="relative top-10 mx-auto p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white">
            <div class="mt-3">
                <h3 class="text-lg font-medium text-gray-900 mb-4">Adicionar Novo Produto</h3>
                <form id="addItemForm" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nome do Produto</label>
                            <input type="text" id="productName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">SKU</label>
                            <input type="text" id="productSKU" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Categoria</label>
                            <select id="productCategory" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                <option value="">Selecione uma categoria</option>
                                <option value="Eletr√¥nicos">Eletr√¥nicos</option>
                                <option value="Roupas">Roupas & Acess√≥rios</option>
                                <option value="Casa">Casa & Jardim</option>
                                <option value="Esportes">Esportes & Fitness</option>
                                <option value="Livros">Livros & M√≠dia</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Vendedor</label>
                            <select id="productSeller" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                <option value="">Selecione um vendedor</option>
                                <option value="CIIG Store">CIIG Store</option>
                                <option value="TechWorld">TechWorld</option>
                                <option value="FashionHub">FashionHub</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Pre√ßo (R$)</label>
                            <input type="number" id="productPrice" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required min="0" step="0.01">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Quantidade</label>
                            <input type="number" id="productQuantity" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required min="0">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Descri√ß√£o</label>
                        <textarea id="productDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Descri√ß√£o detalhada do produto..."></textarea>
                    </div>
                    <div class="flex justify-end space-x-3">
                        <button type="button" onclick="closeModal()" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors">Cancelar</button>
                        <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">Adicionar Produto</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="notificationToast" class="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg hidden notification z-50">
        <div class="flex items-center">
            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
            </svg>
            <span id="toastMessage">Opera√ß√£o realizada com sucesso!</span>
        </div>
    </div>

    <script>
        // Enhanced sample data
        let inventoryData = [
            { id: 1, name: 'iPhone 15 Pro Max 256GB', sku: 'IP15PM256', category: 'Eletr√¥nicos', seller: 'TechWorld', quantity: 45, price: 7999.99, sales: 234, rating: 4.8, status: 'Ativo', lastUpdate: '2024-01-15', description: 'Smartphone Apple com c√¢mera profissional' },
            { id: 2, name: 'Notebook Dell XPS 13', sku: 'DELLXPS13', category: 'Eletr√¥nicos', seller: 'CIIG Store', quantity: 12, price: 4999.99, sales: 89, rating: 4.6, status: 'Ativo', lastUpdate: '2024-01-14', description: 'Ultrabook premium para profissionais' },
            { id: 3, name: 'T√™nis Nike Air Max', sku: 'NIKEAM90', category: 'Esportes', seller: 'FashionHub', quantity: 89, price: 599.99, sales: 456, rating: 4.7, status: 'Ativo', lastUpdate: '2024-01-15', description: 'T√™nis esportivo confort√°vel' },
            { id: 4, name: 'Smart TV Samsung 55"', sku: 'SAMTV55', category: 'Eletr√¥nicos', seller: 'TechWorld', quantity: 0, price: 2799.99, sales: 123, rating: 4.5, status: 'Esgotado', lastUpdate: '2024-01-13', description: 'Smart TV 4K com HDR' },
            { id: 5, name: 'Livro "Clean Code"', sku: 'BOOKCC01', category: 'Livros', seller: 'CIIG Store', quantity: 156, price: 89.99, sales: 789, rating: 4.9, status: 'Ativo', lastUpdate: '2024-01-15', description: 'Guia essencial para programadores' },
            { id: 6, name: 'Cafeteira Nespresso', sku: 'NESCAFE01', category: 'Casa', seller: 'FashionHub', quantity: 8, price: 899.99, sales: 67, rating: 4.4, status: 'Ativo', lastUpdate: '2024-01-14', description: 'M√°quina de caf√© expresso autom√°tica' }
        ];

        let ordersData = [
            { id: 12345, customer: 'Jo√£o Silva', products: 'iPhone 15 Pro, Capa', total: 8199.98, status: 'Entregue', date: '2024-01-15' },
            { id: 12346, customer: 'Maria Santos', products: 'Notebook Dell XPS', total: 4999.99, status: 'Em Tr√¢nsito', date: '2024-01-15' },
            { id: 12347, customer: 'Pedro Costa', products: 'T√™nis Nike, Meia', total: 649.98, status: 'Aguardando Envio', date: '2024-01-14' },
            { id: 12348, customer: 'Ana Oliveira', products: 'Smart TV Samsung', total: 2799.99, status: 'Processando', date: '2024-01-14' }
        ];

        let sellersData = [
            { id: 1, name: 'TechWorld', products: 1247, sales: 'R$ 2.4M', rating: 4.8, status: 'Ativo', joined: '2023-03-15' },
            { id: 2, name: 'FashionHub', products: 856, sales: 'R$ 1.8M', rating: 4.6, status: 'Ativo', joined: '2023-05-22' },
            { id: 3, name: 'CIIG Store', products: 2341, sales: 'R$ 5.2M', rating: 4.9, status: 'Ativo', joined: '2022-01-10' },
            { id: 4, name: 'HomeDecor', products: 432, sales: 'R$ 890K', rating: 4.3, status: 'Pendente', joined: '2024-01-10' }
        ];

        let isDarkMode = false;
        let selectedItems = new Set();
        let charts = {};

        // Enhanced application state
        let currentPage = 1;
        let itemsPerPage = 25;
        let sortField = '';
        let sortDirection = 'asc';
        let filteredData = [...inventoryData];

        // Initialize the application
        function init() {
            loadThemePreference();
            renderTable();
            renderOrdersTable();
            renderSellersGrid();
            initCharts();
            updateStats();
            startRealTimeUpdates();
            updateClock();
            setInterval(updateClock, 1000);
            updatePagination();
        }

        // Load theme preference
        function loadThemePreference() {
            const savedTheme = localStorage.getItem('darkMode');
            if (savedTheme === 'true') {
                isDarkMode = false; // Will be toggled to true
                toggleTheme();
            }
        }

        // Update clock
        function updateClock() {
            const now = new Date();
            const timeElement = document.getElementById('currentTime');
            const dateElement = document.getElementById('currentDate');
            
            if (timeElement) {
                timeElement.textContent = now.toLocaleTimeString('pt-BR', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
            }
            
            if (dateElement) {
                dateElement.textContent = now.toLocaleDateString('pt-BR', { 
                    day: 'numeric', 
                    month: 'long', 
                    year: 'numeric' 
                });
            }
        }

        // Global search functionality
        function globalSearch(event) {
            const searchTerm = event.target.value.toLowerCase();
            if (event.key === 'Enter' && searchTerm) {
                // Search across all data
                const results = [];
                
                // Search inventory
                inventoryData.forEach(item => {
                    if (item.name.toLowerCase().includes(searchTerm) || 
                        item.sku.toLowerCase().includes(searchTerm) ||
                        item.description.toLowerCase().includes(searchTerm)) {
                        results.push({type: 'Produto', name: item.name, data: item});
                    }
                });
                
                // Search orders
                ordersData.forEach(order => {
                    if (order.customer.toLowerCase().includes(searchTerm) || 
                        order.products.toLowerCase().includes(searchTerm)) {
                        results.push({type: 'Pedido', name: `#${order.id} - ${order.customer}`, data: order});
                    }
                });
                
                // Search sellers
                sellersData.forEach(seller => {
                    if (seller.name.toLowerCase().includes(searchTerm)) {
                        results.push({type: 'Vendedor', name: seller.name, data: seller});
                    }
                });
                
                showSearchResults(results);
            }
        }

        // Show search results
        function showSearchResults(results) {
            if (results.length === 0) {
                showToast('Nenhum resultado encontrado', 'error');
                return;
            }
            
            let message = `Encontrados ${results.length} resultados:\n`;
            results.slice(0, 5).forEach(result => {
                message += `‚Ä¢ ${result.type}: ${result.name}\n`;
            });
            
            if (results.length > 5) {
                message += `... e mais ${results.length - 5} resultados`;
            }
            
            alert(message);
        }

        // Toggle quick actions panel
        function toggleQuickActions() {
            const panel = document.getElementById('quickActionsPanel');
            if (panel) {
                panel.classList.toggle('hidden');
            }
        }

        // Quick action functions
        function exportData() {
            const dataToExport = {
                inventory: inventoryData,
                orders: ordersData,
                sellers: sellersData,
                exportDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(dataToExport, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `ciig-data-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
            showToast('Dados exportados com sucesso!');
        }

        function generateReport() {
            const report = {
                totalProducts: inventoryData.length,
                totalOrders: ordersData.length,
                totalSellers: sellersData.length,
                totalRevenue: ordersData.reduce((sum, order) => sum + order.total, 0),
                averageRating: inventoryData.reduce((sum, item) => sum + item.rating, 0) / inventoryData.length,
                lowStockItems: inventoryData.filter(item => item.quantity <= 10).length,
                generatedAt: new Date().toISOString()
            };
            
            const reportStr = `RELAT√ìRIO CIIG SYSTEM
=====================================
Data: ${new Date().toLocaleDateString('pt-BR')}

RESUMO GERAL:
‚Ä¢ Total de Produtos: ${report.totalProducts}
‚Ä¢ Total de Pedidos: ${report.totalOrders}
‚Ä¢ Total de Vendedores: ${report.totalSellers}
‚Ä¢ Receita Total: R$ ${report.totalRevenue.toFixed(2)}
‚Ä¢ Avalia√ß√£o M√©dia: ${report.averageRating.toFixed(1)}/5.0
‚Ä¢ Itens com Estoque Baixo: ${report.lowStockItems}

PRODUTOS MAIS VENDIDOS:
${inventoryData.sort((a, b) => b.sales - a.sales).slice(0, 5).map((item, index) => 
    `${index + 1}. ${item.name} - ${item.sales} vendas`
).join('\n')}

VENDEDORES TOP:
${sellersData.sort((a, b) => parseFloat(b.sales.replace(/[R$M.]/g, '')) - parseFloat(a.sales.replace(/[R$M.]/g, ''))).slice(0, 3).map((seller, index) => 
    `${index + 1}. ${seller.name} - ${seller.sales}`
).join('\n')}
`;
            
            const reportBlob = new Blob([reportStr], {type: 'text/plain'});
            const url = URL.createObjectURL(reportBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `relatorio-ciig-${new Date().toISOString().split('T')[0]}.txt`;
            link.click();
            
            URL.revokeObjectURL(url);
            showToast('Relat√≥rio gerado com sucesso!');
        }

        function backupData() {
            const backup = {
                version: '1.0',
                timestamp: new Date().toISOString(),
                data: {
                    inventory: inventoryData,
                    orders: ordersData,
                    sellers: sellersData
                },
                settings: {
                    darkMode: isDarkMode,
                    itemsPerPage: itemsPerPage
                }
            };
            
            const backupStr = JSON.stringify(backup, null, 2);
            const backupBlob = new Blob([backupStr], {type: 'application/json'});
            const url = URL.createObjectURL(backupBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `backup-ciig-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
            showToast('Backup criado com sucesso!');
        }

        function systemSettings() {
            const settings = prompt(`Configura√ß√µes do Sistema:
1. Tema escuro: ${isDarkMode ? 'Ativado' : 'Desativado'}
2. Itens por p√°gina: ${itemsPerPage}
3. Atualiza√ß√µes autom√°ticas: Ativadas

Digite o n√∫mero da configura√ß√£o que deseja alterar (1-3):`);
            
            switch(settings) {
                case '1':
                    toggleTheme();
                    showToast('Tema alterado!');
                    break;
                case '2':
                    const newItemsPerPage = prompt('Quantos itens por p√°gina?', itemsPerPage);
                    if (newItemsPerPage && !isNaN(newItemsPerPage)) {
                        itemsPerPage = parseInt(newItemsPerPage);
                        document.getElementById('itemsPerPage').value = itemsPerPage;
                        renderTable();
                        showToast('Itens por p√°gina atualizado!');
                    }
                    break;
                case '3':
                    showToast('Configura√ß√£o de atualiza√ß√µes em desenvolvimento...');
                    break;
                default:
                    if (settings !== null) {
                        showToast('Op√ß√£o inv√°lida', 'error');
                    }
            }
        }

        // Refresh activity
        function refreshActivity() {
            showToast('Atividade atualizada!');
            // Simulate new activity
            const activities = [
                'Novo pedido #' + (Math.floor(Math.random() * 10000) + 10000),
                'Produto atualizado: ' + inventoryData[Math.floor(Math.random() * inventoryData.length)].name,
                'Vendedor aprovado: Store' + Math.floor(Math.random() * 100),
                'Estoque reabastecido: ' + inventoryData[Math.floor(Math.random() * inventoryData.length)].name
            ];
            
            console.log('Nova atividade:', activities[Math.floor(Math.random() * activities.length)]);
        }

        // Table sorting
        function sortTable(field) {
            if (sortField === field) {
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                sortField = field;
                sortDirection = 'asc';
            }
            
            // Update sort indicators
            document.querySelectorAll('[id^="sort-"]').forEach(el => {
                el.textContent = '‚ÜïÔ∏è';
            });
            
            const sortIndicator = document.getElementById(`sort-${field}`);
            if (sortIndicator) {
                sortIndicator.textContent = sortDirection === 'asc' ? '‚Üë' : '‚Üì';
            }
            
            // Sort data
            filteredData.sort((a, b) => {
                let aVal = a[field];
                let bVal = b[field];
                
                if (typeof aVal === 'string') {
                    aVal = aVal.toLowerCase();
                    bVal = bVal.toLowerCase();
                }
                
                if (sortDirection === 'asc') {
                    return aVal > bVal ? 1 : -1;
                } else {
                    return aVal < bVal ? 1 : -1;
                }
            });
            
            renderTable();
            updatePagination();
        }

        // Pagination functions
        function changeItemsPerPage() {
            const select = document.getElementById('itemsPerPage');
            itemsPerPage = parseInt(select.value);
            currentPage = 1;
            renderTable();
            updatePagination();
        }

        function updatePagination() {
            const totalItems = filteredData.length;
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            
            // Update showing info
            const start = (currentPage - 1) * itemsPerPage + 1;
            const end = Math.min(currentPage * itemsPerPage, totalItems);
            
            const showingStart = document.getElementById('showingStart');
            const showingEnd = document.getElementById('showingEnd');
            const totalItemsEl = document.getElementById('totalItems');
            
            if (showingStart) showingStart.textContent = start;
            if (showingEnd) showingEnd.textContent = end;
            if (totalItemsEl) totalItemsEl.textContent = totalItems;
            
            // Update buttons
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            if (prevBtn) {
                prevBtn.disabled = currentPage === 1;
                prevBtn.classList.toggle('opacity-50', currentPage === 1);
            }
            
            if (nextBtn) {
                nextBtn.disabled = currentPage === totalPages;
                nextBtn.classList.toggle('opacity-50', currentPage === totalPages);
            }
            
            // Generate page numbers
            const pageNumbers = document.getElementById('pageNumbers');
            if (pageNumbers) {
                pageNumbers.innerHTML = '';
                
                const maxVisiblePages = 5;
                let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
                let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
                
                if (endPage - startPage < maxVisiblePages - 1) {
                    startPage = Math.max(1, endPage - maxVisiblePages + 1);
                }
                
                for (let i = startPage; i <= endPage; i++) {
                    const pageBtn = document.createElement('button');
                    pageBtn.textContent = i;
                    pageBtn.className = `px-3 py-2 border rounded-md text-sm ${
                        i === currentPage 
                            ? 'bg-blue-600 text-white border-blue-600' 
                            : 'border-gray-300 hover:bg-gray-50'
                    }`;
                    pageBtn.onclick = () => goToPageNumber(i);
                    pageNumbers.appendChild(pageBtn);
                }
            }
        }

        function previousPage() {
            if (currentPage > 1) {
                currentPage--;
                renderTable();
                updatePagination();
            }
        }

        function nextPage() {
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                renderTable();
                updatePagination();
            }
        }

        function goToPageNumber(page) {
            currentPage = page;
            renderTable();
            updatePagination();
        }

        function goToPage() {
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            const page = prompt(`Ir para p√°gina (1-${totalPages}):`);
            if (page && !isNaN(page)) {
                const pageNum = parseInt(page);
                if (pageNum >= 1 && pageNum <= totalPages) {
                    goToPageNumber(pageNum);
                } else {
                    showToast('P√°gina inv√°lida', 'error');
                }
            }
        }

        // Additional table functions
        function toggleColumnVisibility() {
            showToast('Funcionalidade de visibilidade de colunas em desenvolvimento...');
        }

        function saveTableView() {
            const view = {
                sortField,
                sortDirection,
                itemsPerPage,
                filters: {
                    search: document.getElementById('searchInput')?.value || '',
                    category: document.getElementById('categoryFilter')?.value || '',
                    status: document.getElementById('statusFilter')?.value || '',
                    seller: document.getElementById('sellerFilter')?.value || ''
                }
            };
            
            localStorage.setItem('tableView', JSON.stringify(view));
            showToast('Visualiza√ß√£o da tabela salva!');
        }

        // Tab management - Fixed to properly handle tab switching
        function showTab(tabName, element) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Show selected tab
            const targetTab = document.getElementById(tabName + 'Tab');
            if (targetTab) {
                targetTab.classList.remove('hidden');
            }
            
            // Update tab links
            document.querySelectorAll('.tab-link').forEach(link => {
                link.classList.remove('tab-active');
                link.classList.add('text-gray-500', 'hover:text-gray-900');
            });
            
            if (element) {
                element.classList.add('tab-active');
                element.classList.remove('text-gray-500', 'hover:text-gray-900');
            }

            // Reinitialize charts if switching to analytics tab
            if (tabName === 'analytics') {
                setTimeout(() => {
                    initAnalyticsCharts();
                }, 100);
            }
        }

        // Toggle theme - Fixed to properly handle all elements
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            const body = document.getElementById('body');
            const header = document.getElementById('header');
            const cards = document.querySelectorAll('.bg-white');
            const tableHead = document.getElementById('tableHead');
            
            if (isDarkMode) {
                body.className = 'bg-gray-900 text-white transition-all duration-300';
                header.className = 'bg-gray-800 shadow-sm border-b border-gray-700 transition-all duration-300';
                cards.forEach(card => {
                    card.classList.remove('bg-white');
                    card.classList.add('bg-gray-800');
                });
                if (tableHead) {
                    tableHead.classList.remove('bg-gray-50');
                    tableHead.classList.add('bg-gray-700');
                }
                document.getElementById('userName').className = 'text-sm font-medium text-gray-300';
            } else {
                body.className = 'bg-gray-50 transition-all duration-300';
                header.className = 'bg-white shadow-sm border-b border-gray-200 transition-all duration-300';
                cards.forEach(card => {
                    card.classList.remove('bg-gray-800');
                    card.classList.add('bg-white');
                });
                if (tableHead) {
                    tableHead.classList.remove('bg-gray-700');
                    tableHead.classList.add('bg-gray-50');
                }
                document.getElementById('userName').className = 'text-sm font-medium text-gray-700';
            }
        }

        // Toggle notifications - Fixed to prevent event bubbling
        function toggleNotifications() {
            const panel = document.getElementById('notificationPanel');
            if (panel) {
                panel.classList.toggle('hidden');
            }
        }

        // Render inventory table with pagination
        function renderTable(data = null) {
            const tbody = document.getElementById('tableBody');
            if (!tbody) return;
            
            // Use filtered data if no specific data provided
            if (!data) {
                data = filteredData;
            } else {
                filteredData = [...data];
            }
            
            tbody.innerHTML = '';

            // Calculate pagination
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const paginatedData = data.slice(startIndex, endIndex);

            paginatedData.forEach(item => {
                const row = document.createElement('tr');
                row.className = isDarkMode ? 'bg-gray-800 hover:bg-gray-700' : 'bg-white hover:bg-gray-50';
                
                const statusColor = getStatusColor(item.status);
                const ratingStars = generateStars(item.rating);
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <input type="checkbox" class="item-checkbox rounded border-gray-300 text-blue-600 focus:ring-blue-500" value="${item.id}" onchange="updateSelection()">
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 h-10 w-10">
                                <div class="h-10 w-10 rounded-lg bg-gray-200 flex items-center justify-center">
                                    <span class="text-xs font-medium text-gray-600">${item.name.substring(0, 2)}</span>
                                </div>
                            </div>
                            <div class="ml-4">
                                <div class="text-sm font-medium ${isDarkMode ? 'text-white' : 'text-gray-900'}">${item.name}</div>
                                <div class="text-sm ${isDarkMode ? 'text-gray-300' : 'text-gray-500'}">${item.sku}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm ${isDarkMode ? 'text-gray-300' : 'text-gray-500'}">${item.seller}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium ${isDarkMode ? 'text-gray-300' : 'text-gray-900'}">R$ ${item.price.toFixed(2)}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm ${isDarkMode ? 'text-gray-300' : 'text-gray-500'}">${item.quantity}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm ${isDarkMode ? 'text-gray-300' : 'text-gray-500'}">${item.sales}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            ${ratingStars}
                            <span class="ml-1 text-sm ${isDarkMode ? 'text-gray-300' : 'text-gray-500'}">${item.rating}</span>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${statusColor}">
                            ${item.status}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <div class="flex space-x-2">
                            <button onclick="editItem(${item.id})" class="text-blue-600 hover:text-blue-900 transition-colors">Editar</button>
                            <button onclick="viewAnalytics(${item.id})" class="text-green-600 hover:text-green-900 transition-colors">Analytics</button>
                            <button onclick="deleteItem(${item.id})" class="text-red-600 hover:text-red-900 transition-colors">Excluir</button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Render orders table - Fixed to handle missing elements
        function renderOrdersTable() {
            const tbody = document.getElementById('ordersTableBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';

            ordersData.forEach(order => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                
                const statusColor = getOrderStatusColor(order.status);
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">#${order.id}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${order.customer}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${order.products}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">R$ ${order.total.toFixed(2)}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${statusColor}">
                            ${order.status}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${formatDate(order.date)}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="viewOrder(${order.id})" class="text-blue-600 hover:text-blue-900 mr-3">Ver</button>
                        <button onclick="trackOrder(${order.id})" class="text-green-600 hover:text-green-900">Rastrear</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Render sellers grid - Fixed to handle missing elements
        function renderSellersGrid() {
            const grid = document.getElementById('sellersGrid');
            if (!grid) return;
            
            grid.innerHTML = '';

            sellersData.forEach(seller => {
                const card = document.createElement('div');
                card.className = 'bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow';
                
                const statusColor = seller.status === 'Ativo' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800';
                const ratingStars = generateStars(seller.rating);
                
                card.innerHTML = `
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center">
                                <span class="text-white font-medium">${seller.name.substring(0, 2)}</span>
                            </div>
                            <div class="ml-3">
                                <h3 class="text-lg font-medium text-gray-900">${seller.name}</h3>
                                <p class="text-sm text-gray-500">Desde ${formatDate(seller.joined)}</p>
                            </div>
                        </div>
                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${statusColor}">
                            ${seller.status}
                        </span>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <div class="text-2xl font-bold text-gray-900">${seller.products}</div>
                            <div class="text-sm text-gray-500">Produtos</div>
                        </div>
                        <div>
                            <div class="text-2xl font-bold text-green-600">${seller.sales}</div>
                            <div class="text-sm text-gray-500">Vendas</div>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            ${ratingStars}
                            <span class="ml-1 text-sm text-gray-500">${seller.rating}</span>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="viewSeller(${seller.id})" class="text-blue-600 hover:text-blue-900 text-sm">Ver</button>
                            <button onclick="contactSeller(${seller.id})" class="text-green-600 hover:text-green-900 text-sm">Contato</button>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        // Generate star rating - Fixed to handle edge cases
        function generateStars(rating) {
            if (!rating || rating < 0) rating = 0;
            if (rating > 5) rating = 5;
            
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            let stars = '';
            
            for (let i = 0; i < fullStars; i++) {
                stars += '<svg class="w-4 h-4 text-yellow-400 fill-current" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>';
            }
            
            if (hasHalfStar) {
                stars += '<svg class="w-4 h-4 text-yellow-400" viewBox="0 0 20 20"><defs><linearGradient id="half"><stop offset="50%" stop-color="currentColor"/><stop offset="50%" stop-color="#D1D5DB"/></linearGradient></defs><path fill="url(#half)" d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>';
            }
            
            const emptyStars = 5 - Math.ceil(rating);
            for (let i = 0; i < emptyStars; i++) {
                stars += '<svg class="w-4 h-4 text-gray-300 fill-current" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>';
            }
            
            return stars;
        }

        // Get status colors - Fixed to handle all cases
        function getStatusColor(status) {
            switch(status) {
                case 'Ativo':
                    return 'bg-green-100 text-green-800';
                case 'Pausado':
                    return 'bg-yellow-100 text-yellow-800';
                case 'Esgotado':
                    return 'bg-red-100 text-red-800';
                default:
                    return 'bg-gray-100 text-gray-800';
            }
        }

        function getOrderStatusColor(status) {
            switch(status) {
                case 'Entregue':
                    return 'bg-green-100 text-green-800';
                case 'Em Tr√¢nsito':
                    return 'bg-blue-100 text-blue-800';
                case 'Aguardando Envio':
                    return 'bg-yellow-100 text-yellow-800';
                case 'Processando':
                    return 'bg-purple-100 text-purple-800';
                default:
                    return 'bg-gray-100 text-gray-800';
            }
        }

        // Format date - Fixed to handle invalid dates
        function formatDate(dateString) {
            try {
                const date = new Date(dateString);
                if (isNaN(date.getTime())) {
                    return 'Data inv√°lida';
                }
                return date.toLocaleDateString('pt-BR');
            } catch (error) {
                return 'Data inv√°lida';
            }
        }

        // Filter table with pagination support
        function filterTable() {
            const searchInput = document.getElementById('searchInput');
            const categoryFilter = document.getElementById('categoryFilter');
            const statusFilter = document.getElementById('statusFilter');
            const sellerFilter = document.getElementById('sellerFilter');

            const searchTerm = searchInput ? searchInput.value.toLowerCase() : '';
            const categoryValue = categoryFilter ? categoryFilter.value : '';
            const statusValue = statusFilter ? statusFilter.value : '';
            const sellerValue = sellerFilter ? sellerFilter.value : '';

            filteredData = inventoryData.filter(item => {
                const matchesSearch = !searchTerm || 
                    item.name.toLowerCase().includes(searchTerm) || 
                    item.sku.toLowerCase().includes(searchTerm) ||
                    item.description.toLowerCase().includes(searchTerm);
                const matchesCategory = !categoryValue || item.category === categoryValue;
                const matchesStatus = !statusValue || item.status === statusValue;
                const matchesSeller = !sellerValue || item.seller === sellerValue;

                return matchesSearch && matchesCategory && matchesStatus && matchesSeller;
            });

            currentPage = 1; // Reset to first page when filtering
            renderTable();
            updatePagination();
        }

        // Selection management - Fixed to handle missing elements
        function updateSelection() {
            const checkboxes = document.querySelectorAll('.item-checkbox:checked');
            selectedItems.clear();
            checkboxes.forEach(cb => selectedItems.add(parseInt(cb.value)));
            
            const bulkActions = document.getElementById('bulkActions');
            const selectedCount = document.getElementById('selectedCount');
            
            if (selectedItems.size > 0) {
                if (bulkActions) bulkActions.classList.remove('hidden');
                if (selectedCount) selectedCount.textContent = selectedItems.size;
            } else {
                if (bulkActions) bulkActions.classList.add('hidden');
            }
        }

        function toggleSelectAll() {
            const selectAll = document.getElementById('selectAll');
            const checkboxes = document.querySelectorAll('.item-checkbox');
            
            if (selectAll && checkboxes.length > 0) {
                checkboxes.forEach(cb => {
                    cb.checked = selectAll.checked;
                });
                updateSelection();
            }
        }

        // Initialize charts - Fixed to handle missing canvas elements
        function initCharts() {
            // Sales Chart
            const salesCtx = document.getElementById('salesChart');
            if (salesCtx) {
                try {
                    charts.sales = new Chart(salesCtx.getContext('2d'), {
                        type: 'line',
                        data: {
                            labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
                            datasets: [{
                                label: 'Vendas (R$ mil)',
                                data: [1200, 1900, 3000, 5000, 2000, 3000],
                                borderColor: 'rgb(59, 130, 246)',
                                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                tension: 0.4,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            }
                        }
                    });
                } catch (error) {
                    console.error('Error creating sales chart:', error);
                }
            }

            // Category Chart
            const categoryCtx = document.getElementById('categoryChart');
            if (categoryCtx) {
                try {
                    charts.category = new Chart(categoryCtx.getContext('2d'), {
                        type: 'doughnut',
                        data: {
                            labels: ['Eletr√¥nicos', 'Roupas', 'Casa', 'Esportes', 'Livros'],
                            datasets: [{
                                data: [35, 25, 20, 15, 5],
                                backgroundColor: [
                                    'rgb(59, 130, 246)',
                                    'rgb(16, 185, 129)',
                                    'rgb(245, 158, 11)',
                                    'rgb(139, 92, 246)',
                                    'rgb(236, 72, 153)'
                                ]
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false
                        }
                    });
                } catch (error) {
                    console.error('Error creating category chart:', error);
                }
            }
        }

        // Initialize analytics charts - Fixed to handle missing elements
        function initAnalyticsCharts() {
            // Conversion Chart
            const conversionCtx = document.getElementById('conversionChart');
            if (conversionCtx && !charts.conversion) {
                try {
                    charts.conversion = new Chart(conversionCtx.getContext('2d'), {
                        type: 'bar',
                        data: {
                            labels: ['Eletr√¥nicos', 'Roupas', 'Casa', 'Esportes', 'Livros'],
                            datasets: [{
                                label: 'Taxa de Convers√£o (%)',
                                data: [12.5, 8.3, 15.7, 9.2, 22.1],
                                backgroundColor: 'rgba(59, 130, 246, 0.8)'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 25
                                }
                            }
                        }
                    });
                } catch (error) {
                    console.error('Error creating conversion chart:', error);
                }
            }

            // Ticket Chart
            const ticketCtx = document.getElementById('ticketChart');
            if (ticketCtx && !charts.ticket) {
                try {
                    charts.ticket = new Chart(ticketCtx.getContext('2d'), {
                        type: 'line',
                        data: {
                            labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
                            datasets: [{
                                label: 'Ticket M√©dio (R$)',
                                data: [245, 289, 356, 423, 387, 445],
                                borderColor: 'rgb(16, 185, 129)',
                                backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                tension: 0.4,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            }
                        }
                    });
                } catch (error) {
                    console.error('Error creating ticket chart:', error);
                }
            }
        }

        // Update statistics - Fixed to handle missing elements
        function updateStats() {
            // This would typically fetch real-time data from an API
            // For demo purposes, we'll simulate some updates
            const totalRevenue = document.getElementById('totalRevenue');
            const todayOrders = document.getElementById('todayOrders');
            const activeSellers = document.getElementById('activeSellers');
            const avgRating = document.getElementById('avgRating');

            if (totalRevenue) totalRevenue.textContent = 'R$ 2.847.392';
            if (todayOrders) todayOrders.textContent = '1,247';
            if (activeSellers) activeSellers.textContent = '2,847';
            if (avgRating) avgRating.textContent = '4.7/5.0';
        }

        // Start real-time updates - Fixed to handle errors gracefully
        function startRealTimeUpdates() {
            setInterval(() => {
                try {
                    // Simulate random updates
                    if (inventoryData.length > 0) {
                        const randomIndex = Math.floor(Math.random() * inventoryData.length);
                        const randomChange = Math.floor(Math.random() * 10) - 5;
                        
                        inventoryData[randomIndex].quantity = Math.max(0, inventoryData[randomIndex].quantity + randomChange);
                        inventoryData[randomIndex].lastUpdate = new Date().toISOString().split('T')[0];
                        
                        // Update status based on quantity
                        if (inventoryData[randomIndex].quantity === 0) {
                            inventoryData[randomIndex].status = 'Esgotado';
                        } else if (inventoryData[randomIndex].quantity <= 10) {
                            inventoryData[randomIndex].status = 'Pausado';
                        } else {
                            inventoryData[randomIndex].status = 'Ativo';
                        }

                        // Only re-render if inventory tab is visible
                        const inventoryTab = document.getElementById('inventoryTab');
                        if (inventoryTab && !inventoryTab.classList.contains('hidden')) {
                            renderTable();
                        }
                    }
                } catch (error) {
                    console.error('Error in real-time update:', error);
                }
            }, 10000); // Update every 10 seconds
        }

        // Modal functions - Fixed to handle missing elements
        function addNewItem() {
            const modal = document.getElementById('addItemModal');
            if (modal) {
                modal.classList.remove('hidden');
            }
        }

        function closeModal() {
            const modal = document.getElementById('addItemModal');
            const form = document.getElementById('addItemForm');
            if (modal) modal.classList.add('hidden');
            if (form) form.reset();
        }

        // Utility functions - Fixed to handle missing elements
        function showToast(message, type = 'success') {
            const toast = document.getElementById('notificationToast');
            const toastMessage = document.getElementById('toastMessage');
            
            if (toast && toastMessage) {
                toastMessage.textContent = message;
                toast.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg notification z-50 ${
                    type === 'success' ? 'bg-green-500' : 'bg-red-500'
                } text-white`;
                
                toast.classList.remove('hidden');
                
                setTimeout(() => {
                    toast.classList.add('hidden');
                }, 3000);
            }
        }

        // Action functions - All fixed to handle errors gracefully
        function editItem(id) {
            try {
                const item = inventoryData.find(item => item.id === id);
                if (item) {
                    const newPrice = prompt(`Editar pre√ßo para ${item.name}:`, item.price);
                    if (newPrice !== null && !isNaN(newPrice) && parseFloat(newPrice) >= 0) {
                        item.price = parseFloat(newPrice);
                        item.lastUpdate = new Date().toISOString().split('T')[0];
                        renderTable();
                        showToast('Pre√ßo atualizado com sucesso!');
                    }
                }
            } catch (error) {
                showToast('Erro ao editar item', 'error');
            }
        }

        function viewAnalytics(id) {
            showToast('Abrindo analytics do produto...', 'success');
        }

        function deleteItem(id) {
            try {
                if (confirm('Tem certeza que deseja excluir este produto?')) {
                    inventoryData = inventoryData.filter(item => item.id !== id);
                    renderTable();
                    showToast('Produto exclu√≠do com sucesso!');
                }
            } catch (error) {
                showToast('Erro ao excluir item', 'error');
            }
        }

        function viewOrder(id) {
            showToast(`Visualizando pedido #${id}...`);
        }

        function trackOrder(id) {
            showToast(`Rastreando pedido #${id}...`);
        }

        function viewSeller(id) {
            showToast('Abrindo perfil do vendedor...');
        }

        function contactSeller(id) {
            showToast('Abrindo chat com vendedor...');
        }

        function addNewSeller() {
            showToast('Funcionalidade de aprova√ß√£o de vendedor em desenvolvimento...');
        }

        // Bulk actions - All fixed to handle errors and missing elements
        function bulkImport() {
            showToast('Funcionalidade de importa√ß√£o CSV em desenvolvimento...');
        }

        function bulkUpdatePrice() {
            try {
                if (selectedItems.size === 0) return;
                const newPrice = prompt('Digite o novo pre√ßo para os itens selecionados:');
                if (newPrice && !isNaN(newPrice) && parseFloat(newPrice) >= 0) {
                    selectedItems.forEach(id => {
                        const item = inventoryData.find(item => item.id === id);
                        if (item) {
                            item.price = parseFloat(newPrice);
                            item.lastUpdate = new Date().toISOString().split('T')[0];
                        }
                    });
                    renderTable();
                    showToast(`Pre√ßos atualizados para ${selectedItems.size} itens!`);
                    selectedItems.clear();
                    const bulkActions = document.getElementById('bulkActions');
                    if (bulkActions) bulkActions.classList.add('hidden');
                }
            } catch (error) {
                showToast('Erro ao atualizar pre√ßos', 'error');
            }
        }

        function bulkUpdateStock() {
            try {
                if (selectedItems.size === 0) return;
                const newStock = prompt('Digite a nova quantidade para os itens selecionados:');
                if (newStock && !isNaN(newStock) && parseInt(newStock) >= 0) {
                    selectedItems.forEach(id => {
                        const item = inventoryData.find(item => item.id === id);
                        if (item) {
                            item.quantity = parseInt(newStock);
                            item.lastUpdate = new Date().toISOString().split('T')[0];
                            item.status = item.quantity === 0 ? 'Esgotado' : 
                                         item.quantity <= 10 ? 'Pausado' : 'Ativo';
                        }
                    });
                    renderTable();
                    showToast(`Estoque atualizado para ${selectedItems.size} itens!`);
                    selectedItems.clear();
                    const bulkActions = document.getElementById('bulkActions');
                    if (bulkActions) bulkActions.classList.add('hidden');
                }
            } catch (error) {
                showToast('Erro ao atualizar estoque', 'error');
            }
        }

        function bulkPause() {
            try {
                if (selectedItems.size === 0) return;
                selectedItems.forEach(id => {
                    const item = inventoryData.find(item => item.id === id);
                    if (item) {
                        item.status = 'Pausado';
                        item.lastUpdate = new Date().toISOString().split('T')[0];
                    }
                });
                renderTable();
                showToast(`${selectedItems.size} itens pausados!`);
                selectedItems.clear();
                const bulkActions = document.getElementById('bulkActions');
                if (bulkActions) bulkActions.classList.add('hidden');
            } catch (error) {
                showToast('Erro ao pausar itens', 'error');
            }
        }

        function bulkDelete() {
            try {
                if (selectedItems.size === 0) return;
                if (confirm(`Tem certeza que deseja excluir ${selectedItems.size} itens?`)) {
                    inventoryData = inventoryData.filter(item => !selectedItems.has(item.id));
                    renderTable();
                    showToast(`${selectedItems.size} itens exclu√≠dos!`);
                    selectedItems.clear();
                    const bulkActions = document.getElementById('bulkActions');
                    if (bulkActions) bulkActions.classList.add('hidden');
                }
            } catch (error) {
                showToast('Erro ao excluir itens', 'error');
            }
        }

        // Form submission - Fixed to handle missing elements and validation
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('addItemForm');
            if (form) {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    try {
                        const productName = document.getElementById('productName');
                        const productSKU = document.getElementById('productSKU');
                        const productCategory = document.getElementById('productCategory');
                        const productSeller = document.getElementById('productSeller');
                        const productPrice = document.getElementById('productPrice');
                        const productQuantity = document.getElementById('productQuantity');
                        const productDescription = document.getElementById('productDescription');

                        if (!productName || !productSKU || !productCategory || !productSeller || !productPrice || !productQuantity) {
                            showToast('Erro: campos obrigat√≥rios n√£o encontrados', 'error');
                            return;
                        }

                        const newItem = {
                            id: Math.max(...inventoryData.map(item => item.id), 0) + 1,
                            name: productName.value,
                            sku: productSKU.value,
                            category: productCategory.value,
                            seller: productSeller.value,
                            quantity: parseInt(productQuantity.value),
                            price: parseFloat(productPrice.value),
                            sales: 0,
                            rating: 0,
                            status: parseInt(productQuantity.value) === 0 ? 'Esgotado' : 
                                    parseInt(productQuantity.value) <= 10 ? 'Pausado' : 'Ativo',
                            lastUpdate: new Date().toISOString().split('T')[0],
                            description: productDescription ? productDescription.value : ''
                        };

                        inventoryData.push(newItem);
                        renderTable();
                        closeModal();
                        showToast('Produto adicionado com sucesso!');
                    } catch (error) {
                        showToast('Erro ao adicionar produto', 'error');
                    }
                });
            }
        });

        // Initialize when page loads - Fixed to handle errors
        window.addEventListener('load', function() {
            try {
                init();
            } catch (error) {
                console.error('Error initializing application:', error);
            }
        });

        // Close notifications when clicking outside - Fixed to handle missing elements
        document.addEventListener('click', function(event) {
            const notificationPanel = document.getElementById('notificationPanel');
            if (notificationPanel && !notificationPanel.contains(event.target)) {
                const isNotificationButton = event.target.closest('button[onclick*="toggleNotifications"]');
                if (!isNotificationButton) {
                    notificationPanel.classList.add('hidden');
                }
            }
        });

        // Close modal when clicking outside - Added for better UX
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('addItemModal');
            if (modal && event.target === modal) {
                closeModal();
            }
        });

        // Keyboard shortcuts - Added for better UX
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const modal = document.getElementById('addItemModal');
                const notificationPanel = document.getElementById('notificationPanel');
                
                if (modal && !modal.classList.contains('hidden')) {
                    closeModal();
                }
                if (notificationPanel && !notificationPanel.classList.contains('hidden')) {
                    notificationPanel.classList.add('hidden');
                }
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'970aa90b74ccb871',t:'MTc1NTQ0OTMyMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
